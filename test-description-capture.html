<!DOCTYPE html>
<html>
<head>
    <title>Description Capture Test</title>
</head>
<body>
    <h1>Testing Description Capture Logic</h1>
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        // Simulate the events coming from the API
        const events = [
            {type: 'data', event: 'agent.text', text: '"Fetching real-time quote data for NVIDIA"'},
            {type: 'data', event: 'agent.tool-start', tool_id: 'tool1', tool: 'Bash', cli_tool: 'mf-market-get'},
        ];
        
        let lastAgentText = null;
        
        function processEvents() {
            events.forEach((event, index) => {
                output.innerHTML += `<h3>Event ${index}: ${event.event}</h3>`;
                
                if (event.event === 'agent.text') {
                    const text = event.text?.trim();
                    output.innerHTML += `<p>Text: "${text}"</p>`;
                    output.innerHTML += `<p>Word count: ${text.split(' ').length}</p>`;
                    
                    if (text && text.split(' ').length <= 12) {
                        lastAgentText = text;
                        output.innerHTML += `<p style="color: green">✓ Captured as description!</p>`;
                    } else {
                        lastAgentText = null;
                        output.innerHTML += `<p style="color: red">✗ Not captured (too long or empty)</p>`;
                    }
                }
                
                if (event.event === 'agent.tool-start') {
                    output.innerHTML += `<p>Last agent text: "${lastAgentText}"</p>`;
                    output.innerHTML += `<p style="color: ${lastAgentText ? 'green' : 'red'}">Description ${lastAgentText ? 'WILL' : 'WILL NOT'} be attached to tool!</p>`;
                }
                
                output.innerHTML += '<hr>';
            });
        }
        
        processEvents();
    </script>
</body>
</html>

